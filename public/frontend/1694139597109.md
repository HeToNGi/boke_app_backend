<a name="XFdeV"></a>
# 对于应⽤，浏览器的地位⼀直很重要
1995年，美国⽹景公司因“⽹景浏览器”的发布⽽快速崛起，之后⽹景试图开发⼀个依靠浏览器的⽹络操 作系统。这引起了微软的注意和警惕，于是同年微软发布Windows 95，并捆绑了IE，⼤获成功，到2002 年，微软就已经占据了浏览器市场80%的份额。<br />直到2008年Chrome浏览器横空出世，这种垄断局⾯才算被打破。Chrome浏览器完全颠覆了之前浏览器的 架构设计，在速度和安全性上占据了绝对优势，市场份额占⽐剧增（据 StatCounter 2019年的统计数据显<br />⽰，Chrome占据了63%市场份额）。在2010年底，Google还推出了⼀款⽹络操作系统⸺ChromeOS。<br />可以看到，浏览器⾃诞⽣之⽇起，其地位就⼀直很重要，⽽且这种重要性还在不断加强。我从浏览器的发展 历程中梳理出了**三个⼤的进化路线，希望能让你了解⽬前的Web应⽤到底能做什么，以及未来能适⽤于那 些新领域**。<br />**第⼀个是应⽤程序Web化**。随着云计算的普及和HTML5技术的快速发展，越来越多的应⽤转向了浏览器/服 务器（B/S）架构，这种改变让浏览器的重要性与⽇俱增，视频、⾳频、游戏⼏⼤核⼼场景也都在往Web的 使⽤场景切换。<br />**第⼆个是Web应⽤移动化**。对于移动设备应⽤，Web天⽣具有开放的基因，虽然在技术层⾯还有问题尚待 解决（⽐如，渲染流程过于复杂且性能不及原⽣应⽤、离线时⽤⼾⽆法使⽤、⽆法接收消息推送、移动端没<br />有⼀级⼊⼝），但Google推出了PWA⽅案来整合Web和本地程序各⾃的优势。顺便说⼀句，PWA也是我个<br />⼈⾮常期待的⽅案。<br />**第三个是Web操作系统化**。在我看来，Web操作系统有两层含义：⼀是利⽤Web技术构建⼀个纯粹的操作 系统，如ChromeOS；⼆是浏览器的底层结构往操作系统架构⽅向发展，在整个架构演化的⼤背景下会牵涉 诸多改变，下⾯列举⼀些我认为相对重要的改变。<br />Chrome朝着SOA的⽅向演化，未来很多模块都会以服务的形式提供给上层应⽤使⽤；<br />在浏览器中引⼊多种编程语⾔的⽀持，⽐如新⽀持的WebAssembly；<br />简化渲染流程，使得渲染过程更加直接⾼效；<br />加⼤对系统设备特性的⽀持；<br />提供对复杂Web项⽬开发的⽀持。<br />也就是说，**浏览器已经逐步演化成了操作系统之上的“操作系统”**。
<a name="yt6af"></a>
# 为什么需要学习浏览器⼯作原理？
前⾯我站在⼤⼚的视⻆，带你回顾了浏览器的发展历程，梳理了浏览器的进化路线，分析了浏览器发展的⼤ 趋势。那接下来，我们再⼀起看看，开发者为什么需要了解浏览器的⼯作原理。
<a name="EA7VE"></a>
## 准确评估Web开发项⽬的可⾏性
随着Web特性的极⼤丰富和浏览器性能的提升，越来越多的项⽬可以⽤Web来开发。所以，了解浏览器是如 何⼯作的，能够让你更加准确地决策是否可以采⽤Web来开发项⽬。<br />举个例⼦，去年我做了⼀个健⾝房虚拟教练项⽬，时间紧，任务重，其中有⼤量的⾼速渲染动画和快速交互 的场景需求。如果采⽤传统的C++来开发界⾯，那基本上不可能按时交付，⽽且后期的维护也会⾮常⿇烦。 于是我决定采⽤Web⽅案来开发界⾯，因为采⽤Web⽅案可以降低开发成本，缩短交付周期。最终利⽤这个<br />⽅案，我实现了这个项⽬的提前交付，并且效果也很喜⼈，⼤家对实现的效果⾮常满意。<br />对于这个例⼦，我认为我所做的最正确的事就是**选对了⽅案**，但反过来想，如果我对浏览器和HTML5的内 容不了解，那可能我很容易就放弃了这个最优⽅案。
<a name="cckcV"></a>
## 从更⾼维度审视⻚⾯
作为⼀名合格的开发者，你还要具备⼀项重要的技能，那就是：**要能站在⽤⼾体验⻆度来考虑⻚⾯性能**。我 们看下⾯⼏个常⻅的⽤⼾体验指标。<br />当⽤⼾请求⼀个⽹站时，如果在1秒内看不到关键内容，⽤⼾会产⽣任务被中断的感觉。<br />当⽤⼾点击某些按钮时，如果100ms内⽆法响应，⽤⼾会感受到延迟。<br />如果Web中的动画没有达到60fps，⽤⼾会感受到动画的卡顿。<br />这⾥的⻚⾯加载时⻓、⽤⼾交互反馈时⻓、Web动画中的帧数都决定了⽤⼾体验的流畅度，并最终决定了⽤<br />⼾体验的效果。在⽤⼾体验尤其重要的今天，我们必须能够有效地解决这些体验问题，以免给产品造成不可 挽回的伤害。<br />但通常，这些指标是由⼀系列的复杂因素导致的。如果你要开发流畅的⻚⾯，或者诊断Web⻚⾯中的性能问 题，那你就需要了解URL是怎么变成⻚⾯的，只有弄懂这些之后，你才可以站在全局的⻆度定位问题或者写 出⾼效的代码。<br />你当然可以把浏览器看成⼀个⿊盒，左边输⼊⼀个URL，经过⿊盒处理之后，右边返回你预期的效果。如果 你对⿊盒⼀⽆所知，你倒依然可以写前端代码，也可以使⽤很多最佳实践的策略来优化代码，这就如同不了 解操作系统的⼯作原理同样可以在操作系统上写应⽤⼀样。<br />但如果你理解了这个⿊盒⼦是如何⼯作的，那情况就不同了。你可以站在更⾼的维度审视你的项⽬，通过全 视野快速定位项⽬中不合理的地⽅。⽐如，⾸屏的显⽰就涉及了DNS、HTTP、DOM解析、CSS阻塞、JavaScript阻塞等技术因素，其中⼀项没处理好就可能导致整个⻚⾯的延时。<br />⽽如果你了解了浏览器的⼯作原理，更加可以把这些知识点串成线，连成⽹，最终形成⾃⼰的知识体系，练 就像专家⼀样思考问题、解决问题的能⼒。
<a name="oyXEh"></a>
## 在快节奏的技术迭代中把握本质
从2011年到现在，前端技术出现了⼤爆炸式增⻓，各种新技术层出不穷。我认为**Node.js是前端发展的⼀个 核⼼推动⼒**。Node.js是基于Chrome的JavaScript引擎V8来实现的，它的特点是可以脱离浏览器环境来执<br />⾏JavaScript，于是⼤家惊讶地发现，原来也可以使⽤JavaScript写服务器程序呀！<br />尽管Node.js的诞⽣时间不⻓，但其周边已经形成了⼀个庞⼤的⽣态系统。与此同时，各种新标准、新技术 纷⾄沓来，前端⽣态空前繁荣。<br />为什么Node.js能如此快速地发展？根本原因还是浏览器功能以及整个前端的开发环境，不⾜以⽀撑⽇益增<br />⻓的需求，所以“变化”是这段时期的主旋律。这种变化直接扩⼤了前端⼯程师的知识半径，**这也导致很多 前端开发⼯程师变成了爆栈⼯程师**。<br />虽然前端技术变化快，不过我觉得这⾥有更⼤的机遇，谁能快速抓住变化，谁就能收获这波变化带来的红 利。<br />我相信，随着脚本执⾏效率的提⾼、⻚⾯渲染性能的提升和开发⼯具链的完善，接下来的前端会进⼊⼀个相 对平稳的阶段。通俗地理解就是：**等到核⼼技术⾜以⽀撑核⼼需求，那么前端⽣态会进⼊⼀个相对稳定的状 态**。<br />如果了解了浏览器的⼯作机制，那么你可以梳理出来前端技术的发展脉络，更加深刻地理解当前的技术，同 时你也会清楚其不⾜之处，以及演化⽅向。那么接下来，我们看看前端技术是如何针对这些核⼼诉求做演进 的？<br />**⾸先是脚本执⾏速度问题**。⽐如针对JavaScript设计缺陷和执⾏效率的问题，可以从以下两个途径去解决：<br />不断修订和更新语⾔本⾝，这样你就应该知道ES6、ES7、ES8，或者TypeScript出现的必要性。这种修订 对⽬前⽣态环境的改动是最⼩的，所以推⾏起来会⽐较容易。<br />颠覆性地使⽤新的语⾔，这就是WebAssembly出现的原因。WebAssembly需要经过编译器编译，所以体 积⼩、执⾏速度快，使⽤它能⼤幅提升语⾔的执⾏效率，但是语⾔本⾝的完善，和⽣态的构建都是需要花 很⻓时间来打造的。<br />**其次是前端模块化开发**。⽐如，随着Web应⽤在各个领域的深⼊，Web⼯程的复杂程度也越来越⾼，这就产<br />⽣了模块化开发的需求，于是相应出现了WebComponents标准。我们所熟悉的React和Vue都在渐进地适 应WebComponents标准，同时各种前端框架的最佳实践也会反过来影响WebComponents标准的制定。<br />如果理解了浏览器⼯作原理，那么你会对WebComponents中涉及的Shawdow DOM、HTML Templates等技术有更深刻的理解。<br />**最后是渲染效率问题**。同样，如果理解浏览器的渲染流程，那么你应该知道⽬前⻚⾯的渲染依然存在很⼤缺 陷，然后你就清楚如何避开这些问题，从⽽开发出更加⾼效的Web应⽤。与此同时，Chrome团队也在着⼿ 改善这些缺陷，⽐如正在开发的下⼀代布局⽅案LayoutNG，还有渲染瘦⾝⽅案Slim Paint，其⽬的都是让渲染变得更加简单和⾼效。<br />综上可以看出，触发这些改变的背后因素是当前技术制约了现实的需求，所以**了解浏览器是如何⼯作的，能 让你站在更⾼维度去理解前端**。

